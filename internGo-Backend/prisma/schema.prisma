generator client {
  provider = "prisma-client-js"
  previewFeatures = ["fullTextSearchPostgres"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Users{
    id String @id @default(uuid())
    roleId Int @default(1)
    planId Int?
    name String
    password String
    email String @unique
    gender String?
    employeeId String?
    skills String[]
    personalEmail String? @unique
    currentAddress String?
    permanentAddress String?
    profilePhoto String?
    resume String?
    batch String?
    year Int?
    designation String?
    phone_no String?
    education Json?
    bankDetails Json?
    certificates_submission_status Boolean?
    status Status?
    dateOfBirth DateTime?
    dateOfJoining DateTime?
    bloodGroup String?
    phase String?
    daysWorked Int @default(0)
    assets Assets[] @relation("UserAssets")
    interactionsAttended Interactions[] @relation("Interaction-Intern")
    interactionsTaken Interactions[] @relation("Interaction-Interviewer")
    dailyUpdates DailyUpdates[] @relation("UserDailyUpdates")
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
    profilePercentage Int? @default(0)
    role Roles @relation("UserRole",fields:[roleId],references:[id])
    plan Plans? @relation("UserPlan",fields:[planId],references:[id])
}

enum Status{
  ACTIVE
  NOT_ACTIVE
  LEAVE
  EXAMINATION
  SHADOWING
  DEPLOYED
}

model Roles{
    id Int @id @default(autoincrement())
    roleName String
    description String
    permissions Json
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    users Users[] @relation("UserRole")
}

model Assets{
    id Int @id @default(autoincrement())
    userId String
    user Users @relation("UserAssets",fields:[userId],references:[id])
    assetType String
    assetName String
    givenOn DateTime
    returnedOn DateTime?
}

model Plans{
    id Int @id @default(autoincrement()) 
    name String
    description String
    milestones Milestones[] @relation("PlanMilestones")
    users Users[] @relation("UserPlan")
    planDays Int
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
}

model Milestones{
    id Int @id @default(autoincrement())
    planId Int
    name String
    milestoneDays Int
    mentorName String
    objectives Objectives[] @relation("PlanObjectives")
    plan Plans @relation("PlanMilestones",fields:[planId],references:[id],onDelete:Cascade)
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
}

model Objectives{
    id Int @id @default(autoincrement())
    milestoneId Int
    name String
    description String
    objectiveDays Int
    noOfInteractions Int
    roadmapType RoadmapType
    milestone Milestones @relation("PlanObjectives",fields:[milestoneId],references:[id],onDelete:Cascade)
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
}

enum RoadmapType{
    DEFAULT
    CUSTOM
}

model DailyUpdates{
    id Int @id @default(autoincrement())
    date DateTime @default(now())
    userId String
    user Users @relation("UserDailyUpdates",fields:[userId],references:[id])
    tasks DailyUpdateTasks[] @relation("DailyUpdateTasks")
    updatedAt DateTime @updatedAt
}

model DailyUpdateTasks{
    id Int @id @default(autoincrement())
    dailyUpdateId Int
    taskName String
    activitiesPlanned String
    activitiesCompleted String
    estimatedTime Int
    actualTime Int
    taskProgress TaskProgress
    dailyUpdate DailyUpdates @relation("DailyUpdateTasks",fields:[dailyUpdateId],references:[id])
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
}

enum TaskProgress{
    PENDING
    COMPLETED
}

model Interactions{
    id Int @id @default(autoincrement())
    name String
    assignedIntern String
    assignedMentor String
    assignedInterviewer String 
    internId String
    interviewerId String
    intern Users @relation("Interaction-Intern",fields:[internId],references:[id])
    interviewer Users @relation("Interaction-Interviewer",fields:[interviewerId],references:[id])
    date DateTime
    time String
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
}